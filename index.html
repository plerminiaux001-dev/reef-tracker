<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Reef Command Center</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h1>ğŸ  389 Reef Command Center</h1>

    <div class="tab-nav">
        <button class="tab-btn active" data-target="dashboard">Dashboard</button>
        <button class="tab-btn" data-target="instructions">Dosing Instructions</button>
        <button class="tab-btn" data-target="mixing">Salt Mixer</button>
    </div>

    <div id="dashboard" class="tab-content active">
        <div class="card" style="margin-bottom: 25px;">
            <h2>Current Status</h2>
            <div class="status-grid" id="statusDisplay">
                <div style="grid-column: span 3; padding: 20px;">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>

        <div class="grid">
            <div class="card">
                <h2>ğŸ“ Add New Log</h2>
                <div class="form-group"><label>Date</label><input type="date" id="date"></div>
                <div class="form-group"><label>Alkalinity (dKH)</label><input type="number" step="0.1" id="alk" min="5" max="12"></div>
                <div class="form-group"><label>Calcium (ppm)</label><input type="number" id="ca" min="300" max="600"></div>
                <div class="form-group"><label>Magnesium (ppm)</label><input type="number" id="mg" min="1000" max="1600"></div>
                <div class="form-group"><label>Nitrate (ppm)</label><input type="number" step="0.1" id="no3"></div>
                <div class="form-group"><label>Phosphate (ppm)</label><input type="number" step="0.01" id="po4"></div>
                <div class="form-group"><label>pH</label><input type="number" step="0.1" id="ph" min="7" max="9"></div>
                <button id="saveEntryBtn">Save Entry</button>
            </div>

            <div class="card">
                <h2>ğŸ§ª Dosing Assistant</h2>
                <p style="color:var(--text-muted);">Red Sea Recipe Calculator</p>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-bottom:15px;">
                    <div class="form-group"><label>Current Ca</label><input type="number" id="calcCurrentCa" placeholder="..."></div>
                    <div class="form-group"><label>Target Ca</label><input type="number" id="calcTargetCa" value="430"></div>
                </div>
                <button id="calcBtn">Calculate Recipe</button>
                <div id="calc-results" style="display:none;"></div>
            </div>
        </div>

        <div class="card">
            <h2 style="margin-bottom: 15px;">ğŸ“ˆ Trends</h2>
            <div class="chart-controls">
                <label class="chart-check-label"><input type="checkbox" data-idx="0" checked> ğŸ”µ Alk</label>
                <label class="chart-check-label"><input type="checkbox" data-idx="1" checked> ğŸŸ£ Ca</label>
                <label class="chart-check-label"><input type="checkbox" data-idx="2"> ğŸŸ  Mg</label>
                <label class="chart-check-label"><input type="checkbox" data-idx="3" checked> ğŸŸ¢ NO3</label>
                <label class="chart-check-label"><input type="checkbox" data-idx="4"> ğŸŸ¤ PO4</label>
                <label class="chart-check-label"><input type="checkbox" data-idx="5"> ğŸ”´ pH</label>
            </div>
            <div class="chart-container">
                <canvas id="tankChart"></canvas>
            </div>
        </div>

        <div class="card" style="margin-top: 25px;">
            <h2>History</h2>
            <button id="refreshBtn" style="width: auto; float: right; padding: 8px 15px; margin-top:-40px; font-size:0.8em;">â†» Sync</button>
            <table id="historyTable">
                <thead><tr><th>Date</th><th>Alk</th><th>Ca</th><th>Mg</th><th>NO3</th><th>PO4</th><th>pH</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div id="instructions" class="tab-content">
        <div class="card highlight" style="margin-bottom: 25px;">
            <h2>ğŸ¤– Hydros Blenny Config</h2>
            <div class="grid-small">
                <div class="status-box" style="background:#6f42c1;">Doser 1<br><small>Ca (Master)</small></div>
                <div class="status-box" style="background:#007bff;">Doser 2<br><small>Alk (2x)</small></div>
                <div class="status-box" style="background:#20c997;">Doser 3<br><small>Iodine (0.5x)</small></div>
                <div class="status-box" style="background:#f59e0b;">Doser 4<br><small>Bio (0.5x)</small></div>
            </div>
            <br>
            <table class="info-table">
                <thead><tr><th>Pump</th><th>Start</th><th>Dose</th></tr></thead>
                <tbody>
                    <tr><td><strong>Doser 1</strong> (Ca)</td><td>00:00</td><td>Base Amount</td></tr>
                    <tr><td><strong>Doser 2</strong> (Alk)</td><td>00:30</td><td>2.0 x [Doser 1]</td></tr>
                    <tr><td><strong>Doser 3</strong> (Trace)</td><td>01:00</td><td>0.5 x [Doser 1]</td></tr>
                    <tr><td><strong>Doser 4</strong> (Trace)</td><td>01:30</td><td>0.5 x [Doser 1]</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="mixing" class="tab-content">
        <div class="card highlight" style="border-top-color: #0dcaf0;">
            <h2>ğŸŒŠ Saltwater Mixing Station</h2>
            <p><strong>Red Sea Coral Pro</strong> Calculator</p>
            <div class="grid">
                <div class="form-group"><label>Water Vol (Gal)</label><input type="number" id="mixVol" value="5"></div>
                <div class="form-group"><label>Target SG</label><input type="number" id="mixTarget" value="1.026" step="0.001"></div>
            </div>
            <button id="btnMix" style="background:#0dcaf0; color:#0f172a;">Calculate Mix</button>
            <div id="mixResult" style="display:none;">
                <h3>ğŸ§‚ Add to Water:</h3>
                <div style="font-size: 1.5em; font-weight: bold;"><span id="resGrams">0</span> g</div>
                <div style="color:var(--text-muted); margin-top:5px;">(~<span id="resCups">0</span> cups)</div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
</body>
</html>
